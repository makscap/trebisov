{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, withCtx as _withCtx } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"govuk-width-container\"\n};\nvar _hoisted_2 = {\n  key: 1,\n  style: {\n    \"padding-bottom\": \"50px\"\n  }\n};\nvar _hoisted_3 = {\n  \"class\": \"govuk-caption-xl idsk-article-pattern__subtitle\"\n};\nvar _hoisted_4 = {\n  \"class\": \"govuk-heading-l\"\n};\nvar _hoisted_5 = {\n  \"class\": \"govuk-body-s idsk-article-pattern__text-silver--down\"\n};\nvar _hoisted_6 = /*#__PURE__*/_createElementVNode(\"hr\", {\n  \"class\": \"idsk-crossroad-line\",\n  \"aria-hidden\": \"true\"\n}, null, -1 /* HOISTED */);\nvar _hoisted_7 = /*#__PURE__*/_createElementVNode(\"h3\", {\n  \"class\": \"govuk-heading-s black\"\n}, \"Súvisiace témy:\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_LoadingSpin = _resolveComponent(\"LoadingSpin\");\n  var _component_Markdown = _resolveComponent(\"Markdown\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [!$data.loaded ? (_openBlock(), _createBlock(_component_LoadingSpin, {\n    key: 0\n  })) : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"span\", _hoisted_3, _toDisplayString($props.title), 1 /* TEXT */), _createElementVNode(\"h1\", _hoisted_4, _toDisplayString($data.article.name), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_5, \" Publikované \" + _toDisplayString($options.formatDate(new Date($data.article.publishedAt))), 1 /* TEXT */), _hoisted_6, _createVNode(_component_Markdown, {\n    source: $data.article.body,\n    html: true,\n    \"class\": \"markdown\"\n  }, null, 8 /* PROPS */, [\"source\"]), _createCommentVNode(\" <ArticleGallerySlider\\n        v-if=\\\"\\n          article.photoGallery[0] &&\\n          article.photoGallery[0].images.data.length > 0\\n        \\\"\\n        :images=\\\"\\n          article.photoGallery[0] &&\\n          article.photoGallery[0].images.data.length > 0\\n            ? article.photoGallery[0].images.data\\n            : []\\n        \\\"\\n      ></ArticleGallerySlider> \"), _createCommentVNode(\"      <h3 class=\\\"govuk-heading-s black\\\">Zdieľať tento článok:</h3>\"), _createCommentVNode(\"      <div\"), _createCommentVNode(\"        class=\\\"ss-box\\\"\"), _createCommentVNode(\"        data-ss-social=\\\"facebook\\\"\"), _createCommentVNode(\"        v-if=\\\"pathname\\\"\"), _createCommentVNode(\"        :data-ss-link=\\\"pathname\\\"\"), _createCommentVNode(\"      ></div>\"), _createCommentVNode(\"      <hr\"), _createCommentVNode(\"        class=\\\"idsk-crossroad-line\\\"\"), _createCommentVNode(\"        style=\\\"background-color: black\\\"\"), _createCommentVNode(\"        aria-hidden=\\\"true\\\"\"), _createCommentVNode(\"      />\"), _hoisted_7, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.similarArticles, function (similar, index) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index\n    }, [_createVNode(_component_router_link, {\n      to: $options.getCrazyUrl(similar),\n      \"class\": \"govuk-link-custom\"\n    }, {\n      \"default\": _withCtx(function () {\n        return [_createTextVNode(_toDisplayString(similar.attributes.name), 1 /* TEXT */)];\n      }),\n\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])]);\n  }), 128 /* KEYED_FRAGMENT */))]))]);\n}","map":{"version":3,"mappings":";;;;EACO,SAAM;AAAuB;;;EAEpBA,KAA4B,EAA5B;IAAA;EAAA;;;EACJ,SAAM;AAAiD;;EAGzD,SAAM;AAAiB;;EACxB,SAAM;AAAsD;8BAG/DC,oBAAqD;EAAjD,SAAM,qBAAqB;EAAC,aAAW,EAAC;;8BA2B5CA,oBAAsD;EAAlD,SAAM;AAAuB,GAAC,iBAAe;;;;;;uBArCrDC,oBA4CM,OA5CNC,UA4CM,IA3CgBC,YAAM,kBAA1BC,aAA0CC;IAAAC;EAAA,qBAC1CL,oBAyCM,OAzCNM,UAyCM,GAxCJP,oBAES,QAFTQ,UAES,mBADPC,YAAK,kBAEPT,oBAAmD,MAAnDU,UAAmD,mBAApBP,aAAO,CAACQ,IAAI,kBAC3CX,oBAEI,KAFJY,UAEI,EAF4D,eAClD,oBAAGC,mBAAU,KAAKC,IAAI,CAACX,aAAO,CAACY,WAAW,oBAExDC,UAAqD,EACrDC,aAAiEC;IAAtDC,MAAM,EAAEhB,aAAO,CAACiB,IAAI;IAAGC,IAAI,EAAE,IAAI;IAAE,SAAM;uCACpDC,gZAW4B,EAE5BA,2FAAyE,EACzEA,iCAAiB,EACjBA,+CAA6B,EAC7BA,0DAAwC,EACxCA,gDAA8B,EAC9BA,yDAAuC,EACvCA,oCAAoB,EACpBA,gCAAgB,EAChBA,4DAA0C,EAC1CA,gEAA8C,EAC9CA,mDAAiC,EACjCA,+BAAe,EACfC,UAAsD,qBACtDtB,oBAIMuB,6BAJ0BrB,qBAAe,YAAlCsB,OAAO,EAAEC,KAAK;yBAA3BzB,oBAIM;MAJ4CK,GAAG,EAAEoB;IAAK,IAC1DT,aAEcU;MAFAC,EAAE,EAAEf,oBAAW,CAACY,OAAO;MAAG,SAAM;;0BAC5C;QAAA,OAA6B,mCAA1BA,OAAO,CAACI,UAAU,CAAClB,IAAI","names":["style","_createElementVNode","_createElementBlock","_hoisted_1","$data","_createBlock","_component_LoadingSpin","key","_hoisted_2","_hoisted_3","$props","_hoisted_4","name","_hoisted_5","$options","Date","publishedAt","_hoisted_6","_createVNode","_component_Markdown","source","body","html","_createCommentVNode","_hoisted_7","_Fragment","similar","index","_component_router_link","to","attributes"],"sourceRoot":"","sources":["/Users/Maksym/Documents/GitHub/trebisov/frontend/src/views/ArticleView.vue"],"sourcesContent":["<template>\n  <div class=\"govuk-width-container\">\n    <LoadingSpin v-if=\"!loaded\"></LoadingSpin>\n    <div v-else style=\"padding-bottom: 50px\">\n      <span class=\"govuk-caption-xl idsk-article-pattern__subtitle\">{{\n        title\n      }}</span>\n      <h1 class=\"govuk-heading-l\">{{ article.name }}</h1>\n      <p class=\"govuk-body-s idsk-article-pattern__text-silver--down\">\n        Publikované {{ formatDate(new Date(article.publishedAt)) }}\n      </p>\n      <hr class=\"idsk-crossroad-line\" aria-hidden=\"true\" />\n      <Markdown :source=\"article.body\" :html=\"true\" class=\"markdown\" />\n      <!-- <ArticleGallerySlider\n        v-if=\"\n          article.photoGallery[0] &&\n          article.photoGallery[0].images.data.length > 0\n        \"\n        :images=\"\n          article.photoGallery[0] &&\n          article.photoGallery[0].images.data.length > 0\n            ? article.photoGallery[0].images.data\n            : []\n        \"\n      ></ArticleGallerySlider> -->\n\n      <!--      <h3 class=\"govuk-heading-s black\">Zdieľať tento článok:</h3>-->\n      <!--      <div-->\n      <!--        class=\"ss-box\"-->\n      <!--        data-ss-social=\"facebook\"-->\n      <!--        v-if=\"pathname\"-->\n      <!--        :data-ss-link=\"pathname\"-->\n      <!--      ></div>-->\n      <!--      <hr-->\n      <!--        class=\"idsk-crossroad-line\"-->\n      <!--        style=\"background-color: black\"-->\n      <!--        aria-hidden=\"true\"-->\n      <!--      />-->\n      <h3 class=\"govuk-heading-s black\">Súvisiace témy:</h3>\n      <div v-for=\"(similar, index) in similarArticles\" :key=\"index\">\n        <router-link :to=\"getCrazyUrl(similar)\" class=\"govuk-link-custom\">\n          {{ similar.attributes.name }}\n        </router-link>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Markdown from \"vue3-markdown-it\";\nimport LoadingSpin from \"@/components/Loader\";\n// import ArticleGallerySlider from \"@/components/ArticleGallerySlider\";\nimport { useMeta } from \"vue-meta\";\n\nexport default {\n  data() {\n    return {\n      articleId: -1,\n      article: \"\",\n      similarArticles: [],\n      loaded: false,\n      pathname: \"\",\n      types: [\n        { slug: \"aktivity\", value: \"Aktivity\" },\n        { slug: \"chodci\", value: \"Chodci\" },\n        { slug: \"cyklisti\", value: \"Cyklisti\" },\n        { slug: \"deti\", value: \"Deti\" },\n        { slug: \"mladi-vodici\", value: \"Mladí vodiči\" },\n        { slug: \"motocyklisti\", value: \"Motocyklisti\" },\n        { slug: \"profesionali\", value: \"Profesionáli\" },\n        { slug: \"seniori\", value: \"Seniori\" },\n        { slug: \"vizia-nula\", value: \"Vízia nula\" },\n        { slug: \"vodici\", value: \"Vodiči\" },\n      ],\n    };\n  },\n  props: {\n    title: String,\n  },\n  setup() {\n    useMeta({\n      title: \"Aktualita\",\n      htmlAttrs: { lang: \"sk\", amp: true },\n      meta: [\n        { charset: \"utf-8\" },\n        {\n          name: \"description\",\n          content:\n            \"Národný kooridnátor pre zvyšovanie bezpečnosti cestnej premávky\",\n        },\n        {\n          name: \"viewport\",\n          content: \"width=device-width, initial-scale=1\",\n        },\n      ],\n    });\n  },\n  components: {\n    Markdown,\n    LoadingSpin,\n    // ArticleGallerySlider,\n  },\n  beforeMount() {\n    this.articleId = this.$route.query.id;\n    this.getCategories();\n    this.getArticle();\n  },\n  mounted() {\n    console.log(window.location.origin + window.location.pathname);\n    this.pathname = window.location.origin + window.location.pathname;\n  },\n  methods: {\n    async getArticle() {\n      const res = await fetch(\n        process.env.VUE_APP_API_URL +\n          `/articles/${this.articleId}/?populate=deep`\n      );\n      const jsonData = await res.json();\n      this.article = jsonData.data.attributes;\n      if (this.article.photoGallery.length !== 0)\n        this.photos = this.article.photoGallery[0].images.data;\n      this.loaded = true;\n      await this.getSimilarArticles();\n    },\n    async getCategories() {\n      // console.log(\"toto su typy before\", this.types);\n      const res = await fetch(process.env.VUE_APP_API_URL + `/categories`);\n      const jsonData = await res.json();\n      this.types = this.types.map((type) => {\n        const data = jsonData.data.find((d) => {\n          return d.attributes.name === type.value;\n        });\n        return { slug: type.slug, value: type.value, id: data.id };\n      });\n    },\n    async getSimilarArticles() {\n      const res = await fetch(\n        process.env.VUE_APP_API_URL +\n          \"/articles/?populate[0]=categories&populate[1]=titleImage&populate[2]=photoGallery.images&sort[0]=datetime%3Adesc\"\n      );\n      const jsonData = await res.json();\n      const filter = jsonData.data\n        .sort((a, b) => b.id - a.id)\n        .filter((e) => e.id !== this.articleId)\n        .slice(0, 2);\n      if (filter) this.similarArticles = filter;\n    },\n    padTo2Digits(num) {\n      return num.toString().padStart(2, \"0\");\n    },\n    formatDate(date) {\n      return [\n        this.padTo2Digits(date.getDate()),\n        this.padTo2Digits(date.getMonth() + 1),\n        date.getFullYear(),\n      ].join(\".\");\n    },\n    toNormalForm(str) {\n      return (\n        str\n          .normalize(\"NFD\")\n          .replace(/[\\u0300-\\u036f]/g, \"\")\n          .replaceAll(\" \", \"-\")\n          .toLowerCase()\n          .substring(0, 30) + \"...\"\n      );\n    },\n    getCrazyUrl(article) {\n      return `/aktuality/${\n        this.types.find(\n          (t) => t.id === article.attributes.categories.data[0].id\n        )?.slug\n      }?id=${article.id}&name=${this.toNormalForm(article.attributes.name)}`;\n    },\n    printLog(value) {\n      console.log(\"log\", value);\n    },\n  },\n  watch: {\n    $route: {\n      // eslint-disable-next-line no-unused-vars\n      handler: function (val, oldVal) {\n        this.loaded = false;\n        this.articleId = this.$route.query.id;\n        this.getCategories();\n        this.getArticle();\n      },\n      deep: true,\n    },\n  },\n};\n</script>\n\n<style>\n.markdown img {\n  width: 100% !important;\n  object-fit: contain !important;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}
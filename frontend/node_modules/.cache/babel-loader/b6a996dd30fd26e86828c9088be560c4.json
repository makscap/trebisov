{"ast":null,"code":"import \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.function.bind.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.timers.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport '../../../govuk/vendor/polyfills/Function/prototype/bind';\nimport '../../../govuk/vendor/polyfills/Event'; // addEventListener and event.target normalization\n\nfunction InPageNavigation($module) {\n  this.$module = $module;\n}\nInPageNavigation.prototype.init = function () {\n  // Check for module\n  var $module = this.$module;\n  if (!$module) {\n    return;\n  }\n\n  // Check for button\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__link');\n  if (!$links) {\n    return;\n  }\n\n  // list of all ids and titles\n  this.$arrTitlesAndElems = [];\n  // Handle $link click events\n  $links.forEach(function ($link) {\n    var $item = {};\n    $item.el = document.getElementById($link.href.split('#')[1]);\n    this.$arrTitlesAndElems.push($item);\n    $link.addEventListener('click', this.handleClickLink.bind(this));\n  }.bind(this));\n  var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel');\n  if (!$linkPanelButton) {\n    return;\n  }\n  $module.boundCheckCloseClick = this.checkCloseClick.bind(this);\n  $module.boundHandleClickLinkPanel = this.handleClickLinkPanel.bind(this);\n  $linkPanelButton.addEventListener('click', $module.boundHandleClickLinkPanel, true);\n\n  // Handle floating navigation\n  window.addEventListener('scroll', this.scrollFunction.bind(this));\n  // Handle case if the viewport is shor and there are more than one article - scrolling is not needed, but navigation pointer has to be updated\n  this.$module.labelChanged = false;\n};\n\n/**\n * An event handler for click event on $link - add actual title to link panel\n * @param {object} e\n */\nInPageNavigation.prototype.handleClickLink = function (e) {\n  var $link = e.target || e.srcElement;\n  var $id = $link.closest('.idsk-in-page-navigation__link').href.split('#')[1];\n  var $panelHeight = this.$module.getElementsByClassName('idsk-in-page-navigation__link-panel')[0].offsetHeight;\n  setTimeout(function () {\n    if (document.getElementById($id) != null) {\n      this.$module.labelChanged = true;\n      this.changeCurrentLink($link);\n      window.scrollTo(0, document.getElementById($id).offsetTop - $panelHeight * 2.5);\n    } else {\n      this.changeCurrentLink($link);\n    }\n  }.bind(this), 10);\n};\n\n/**\n * An event handler for click event on $linkPanel - collapse or expand in page navigation menu\n * @param {object} e\n */\nInPageNavigation.prototype.handleClickLinkPanel = function (e) {\n  var $module = this.$module;\n  var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel');\n  $module.classList.add('idsk-in-page-navigation--expand');\n  $linkPanelButton.removeEventListener('click', $module.boundHandleClickLinkPanel, true);\n  document.addEventListener('click', $module.boundCheckCloseClick, true);\n};\n\n/**\n * close navigation if the user click outside navigation\n * @param {object} e\n */\nInPageNavigation.prototype.checkCloseClick = function (e) {\n  var $el = e.target || e.srcElement;\n  var $navigationList = $el.closest('.idsk-in-page-navigation__list');\n  var $module = this.$module;\n  var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel');\n  if ($navigationList == null) {\n    e.stopPropagation(); // prevent bubbling\n    $module.classList.remove('idsk-in-page-navigation--expand');\n    $linkPanelButton.addEventListener('click', $module.boundHandleClickLinkPanel, true);\n    document.removeEventListener('click', $module.boundCheckCloseClick, true);\n  }\n};\n\n/**\n * When the user scrolls down from the top of the document, set position to fixed\n */\nInPageNavigation.prototype.scrollFunction = function () {\n  var $module = this.$module;\n  var $arrTitlesAndElems = this.$arrTitlesAndElems;\n  var $parentModule = $module.parentElement;\n  var $navTopPosition = $parentModule.offsetTop - 55; // padding\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__list-item');\n  if (window.pageYOffset <= $navTopPosition) {\n    $module.classList.remove('idsk-in-page-navigation--sticky');\n  } else {\n    $module.classList.add('idsk-in-page-navigation--sticky');\n  }\n  if (this.$module.labelChanged) {\n    this.$module.labelChanged = false;\n  } else if ($module.classList.contains('idsk-in-page-navigation--sticky')) {\n    var $self = this;\n    $arrTitlesAndElems.some(function ($item, $index) {\n      if ($item.el.offsetTop >= window.scrollY && $item.el.offsetTop <= window.scrollY + window.innerHeight) {\n        $self.changeCurrentLink($links[$index]);\n        return true;\n      }\n    });\n  } else {\n    this.changeCurrentLink($links[0]);\n  }\n};\nInPageNavigation.prototype.changeCurrentLink = function (el) {\n  var $module = this.$module;\n  var $currItem = el.closest('.idsk-in-page-navigation__list-item');\n  var $articleTitle = $currItem.querySelector('.idsk-in-page-navigation__link-title');\n  var $items = $module.querySelectorAll('.idsk-in-page-navigation__list-item');\n  var $linkPanelText = $module.querySelector('.idsk-in-page-navigation__link-panel-button');\n  $items.forEach(function ($item) {\n    $item.classList.remove('idsk-in-page-navigation__list-item--active');\n  });\n  $currItem.classList.add('idsk-in-page-navigation__list-item--active');\n  $linkPanelText.innerText = $articleTitle.innerText;\n\n  // let active item be always visible\n  $currItem.scrollIntoView({\n    block: \"nearest\",\n    inline: \"nearest\"\n  });\n};\nexport default InPageNavigation;","map":{"version":3,"names":["InPageNavigation","$module","prototype","init","$links","querySelectorAll","$arrTitlesAndElems","forEach","$link","$item","el","document","getElementById","href","split","push","addEventListener","handleClickLink","bind","$linkPanelButton","querySelector","boundCheckCloseClick","checkCloseClick","boundHandleClickLinkPanel","handleClickLinkPanel","window","scrollFunction","labelChanged","e","target","srcElement","$id","closest","$panelHeight","getElementsByClassName","offsetHeight","setTimeout","changeCurrentLink","scrollTo","offsetTop","classList","add","removeEventListener","$el","$navigationList","stopPropagation","remove","$parentModule","parentElement","$navTopPosition","pageYOffset","contains","$self","some","$index","scrollY","innerHeight","$currItem","$articleTitle","$items","$linkPanelText","innerText","scrollIntoView","block","inline"],"sources":["/Users/Maksym/Documents/GitHub/trebisov/frontend/node_modules/@id-sk/frontend/idsk/components/in-page-navigation/in-page-navigation.js"],"sourcesContent":["import '../../../govuk/vendor/polyfills/Function/prototype/bind'\nimport '../../../govuk/vendor/polyfills/Event' // addEventListener and event.target normalization\n\nfunction InPageNavigation($module) {\n    this.$module = $module\n}\n\nInPageNavigation.prototype.init = function () {\n    // Check for module\n    var $module = this.$module\n    if (!$module) {\n        return\n    }\n\n    // Check for button\n    var $links = $module.querySelectorAll('.idsk-in-page-navigation__link')\n    if (!$links) {\n        return\n    }\n\n    // list of all ids and titles\n    this.$arrTitlesAndElems = []\n    // Handle $link click events\n    $links.forEach(function ($link) {\n        var $item = {}\n        $item.el = document.getElementById($link.href.split('#')[1])\n        this.$arrTitlesAndElems.push($item)\n        $link.addEventListener('click', this.handleClickLink.bind(this))\n    }.bind(this))\n\n    var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel')\n    if (!$linkPanelButton) {\n        return\n    }\n    $module.boundCheckCloseClick = this.checkCloseClick.bind(this)\n    $module.boundHandleClickLinkPanel = this.handleClickLinkPanel.bind(this)\n    $linkPanelButton.addEventListener('click', $module.boundHandleClickLinkPanel, true)\n\n    // Handle floating navigation\n    window.addEventListener('scroll', this.scrollFunction.bind(this))\n    // Handle case if the viewport is shor and there are more than one article - scrolling is not needed, but navigation pointer has to be updated\n    this.$module.labelChanged = false\n}\n\n/**\n * An event handler for click event on $link - add actual title to link panel\n * @param {object} e\n */\nInPageNavigation.prototype.handleClickLink = function (e) {\n    var $link = e.target || e.srcElement\n    var $id = $link.closest('.idsk-in-page-navigation__link').href.split('#')[1]\n    var $panelHeight = this.$module.getElementsByClassName('idsk-in-page-navigation__link-panel')[0].offsetHeight\n\n    setTimeout(function () {\n        if (document.getElementById($id) != null) {\n            this.$module.labelChanged = true\n            this.changeCurrentLink($link)\n            window.scrollTo(0, document.getElementById($id).offsetTop - ($panelHeight * 2.5))\n        } else {\n            this.changeCurrentLink($link)\n        }\n    }.bind(this), 10)\n}\n\n/**\n * An event handler for click event on $linkPanel - collapse or expand in page navigation menu\n * @param {object} e\n */\nInPageNavigation.prototype.handleClickLinkPanel = function (e) {\n    var $module = this.$module\n    var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel')\n\n    $module.classList.add('idsk-in-page-navigation--expand')\n    $linkPanelButton.removeEventListener('click', $module.boundHandleClickLinkPanel, true)\n    document.addEventListener('click', $module.boundCheckCloseClick, true)\n}\n\n/**\n * close navigation if the user click outside navigation\n * @param {object} e\n */\nInPageNavigation.prototype.checkCloseClick = function (e) {\n    var $el = e.target || e.srcElement\n    var $navigationList = $el.closest('.idsk-in-page-navigation__list')\n    var $module = this.$module\n    var $linkPanelButton = $module.querySelector('.idsk-in-page-navigation__link-panel')\n\n    if ($navigationList == null) {\n        e.stopPropagation() // prevent bubbling\n        $module.classList.remove('idsk-in-page-navigation--expand')\n        $linkPanelButton.addEventListener('click', $module.boundHandleClickLinkPanel, true)\n        document.removeEventListener('click', $module.boundCheckCloseClick, true)\n    }\n}\n\n/**\n * When the user scrolls down from the top of the document, set position to fixed\n */\nInPageNavigation.prototype.scrollFunction = function () {\n    var $module = this.$module\n    var $arrTitlesAndElems = this.$arrTitlesAndElems\n    var $parentModule = $module.parentElement\n    var $navTopPosition = $parentModule.offsetTop - 55 // padding\n    var $links = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n\n    if (window.pageYOffset <= $navTopPosition) {\n        $module.classList.remove('idsk-in-page-navigation--sticky')\n    } else {\n        $module.classList.add('idsk-in-page-navigation--sticky')\n    }\n\n    if (this.$module.labelChanged) {\n        this.$module.labelChanged = false\n    } else if ($module.classList.contains('idsk-in-page-navigation--sticky')) {\n        var $self = this\n        $arrTitlesAndElems.some(function ($item, $index) {\n            if ($item.el.offsetTop >= window.scrollY && $item.el.offsetTop <= (window.scrollY + window.innerHeight)) {\n                $self.changeCurrentLink($links[$index])\n\n                return true\n            }\n        })\n    } else {\n        this.changeCurrentLink($links[0])\n    }\n}\n\nInPageNavigation.prototype.changeCurrentLink = function (el) {\n    var $module = this.$module\n    var $currItem = el.closest('.idsk-in-page-navigation__list-item')\n    var $articleTitle = $currItem.querySelector('.idsk-in-page-navigation__link-title')\n    var $items = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n    var $linkPanelText = $module.querySelector('.idsk-in-page-navigation__link-panel-button')\n\n    $items.forEach(function ($item) {\n        $item.classList.remove('idsk-in-page-navigation__list-item--active')\n    })\n    $currItem.classList.add('idsk-in-page-navigation__list-item--active')\n    $linkPanelText.innerText = $articleTitle.innerText\n\n    // let active item be always visible\n    $currItem.scrollIntoView({\n      block: \"nearest\",\n      inline: \"nearest\"\n    });\n}\n\nexport default InPageNavigation\n"],"mappings":";;;;;;;AAAA,OAAO,yDAAyD;AAChE,OAAO,uCAAuC,EAAC;;AAE/C,SAASA,gBAAgB,CAACC,OAAO,EAAE;EAC/B,IAAI,CAACA,OAAO,GAAGA,OAAO;AAC1B;AAEAD,gBAAgB,CAACE,SAAS,CAACC,IAAI,GAAG,YAAY;EAC1C;EACA,IAAIF,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAI,CAACA,OAAO,EAAE;IACV;EACJ;;EAEA;EACA,IAAIG,MAAM,GAAGH,OAAO,CAACI,gBAAgB,CAAC,gCAAgC,CAAC;EACvE,IAAI,CAACD,MAAM,EAAE;IACT;EACJ;;EAEA;EACA,IAAI,CAACE,kBAAkB,GAAG,EAAE;EAC5B;EACAF,MAAM,CAACG,OAAO,CAAC,UAAUC,KAAK,EAAE;IAC5B,IAAIC,KAAK,GAAG,CAAC,CAAC;IACdA,KAAK,CAACC,EAAE,GAAGC,QAAQ,CAACC,cAAc,CAACJ,KAAK,CAACK,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC5D,IAAI,CAACR,kBAAkB,CAACS,IAAI,CAACN,KAAK,CAAC;IACnCD,KAAK,CAACQ,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACC,eAAe,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;EACpE,CAAC,CAACA,IAAI,CAAC,IAAI,CAAC,CAAC;EAEb,IAAIC,gBAAgB,GAAGlB,OAAO,CAACmB,aAAa,CAAC,sCAAsC,CAAC;EACpF,IAAI,CAACD,gBAAgB,EAAE;IACnB;EACJ;EACAlB,OAAO,CAACoB,oBAAoB,GAAG,IAAI,CAACC,eAAe,CAACJ,IAAI,CAAC,IAAI,CAAC;EAC9DjB,OAAO,CAACsB,yBAAyB,GAAG,IAAI,CAACC,oBAAoB,CAACN,IAAI,CAAC,IAAI,CAAC;EACxEC,gBAAgB,CAACH,gBAAgB,CAAC,OAAO,EAAEf,OAAO,CAACsB,yBAAyB,EAAE,IAAI,CAAC;;EAEnF;EACAE,MAAM,CAACT,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACU,cAAc,CAACR,IAAI,CAAC,IAAI,CAAC,CAAC;EACjE;EACA,IAAI,CAACjB,OAAO,CAAC0B,YAAY,GAAG,KAAK;AACrC,CAAC;;AAED;AACA;AACA;AACA;AACA3B,gBAAgB,CAACE,SAAS,CAACe,eAAe,GAAG,UAAUW,CAAC,EAAE;EACtD,IAAIpB,KAAK,GAAGoB,CAAC,CAACC,MAAM,IAAID,CAAC,CAACE,UAAU;EACpC,IAAIC,GAAG,GAAGvB,KAAK,CAACwB,OAAO,CAAC,gCAAgC,CAAC,CAACnB,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC5E,IAAImB,YAAY,GAAG,IAAI,CAAChC,OAAO,CAACiC,sBAAsB,CAAC,qCAAqC,CAAC,CAAC,CAAC,CAAC,CAACC,YAAY;EAE7GC,UAAU,CAAC,YAAY;IACnB,IAAIzB,QAAQ,CAACC,cAAc,CAACmB,GAAG,CAAC,IAAI,IAAI,EAAE;MACtC,IAAI,CAAC9B,OAAO,CAAC0B,YAAY,GAAG,IAAI;MAChC,IAAI,CAACU,iBAAiB,CAAC7B,KAAK,CAAC;MAC7BiB,MAAM,CAACa,QAAQ,CAAC,CAAC,EAAE3B,QAAQ,CAACC,cAAc,CAACmB,GAAG,CAAC,CAACQ,SAAS,GAAIN,YAAY,GAAG,GAAI,CAAC;IACrF,CAAC,MAAM;MACH,IAAI,CAACI,iBAAiB,CAAC7B,KAAK,CAAC;IACjC;EACJ,CAAC,CAACU,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC;AACrB,CAAC;;AAED;AACA;AACA;AACA;AACAlB,gBAAgB,CAACE,SAAS,CAACsB,oBAAoB,GAAG,UAAUI,CAAC,EAAE;EAC3D,IAAI3B,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAIkB,gBAAgB,GAAGlB,OAAO,CAACmB,aAAa,CAAC,sCAAsC,CAAC;EAEpFnB,OAAO,CAACuC,SAAS,CAACC,GAAG,CAAC,iCAAiC,CAAC;EACxDtB,gBAAgB,CAACuB,mBAAmB,CAAC,OAAO,EAAEzC,OAAO,CAACsB,yBAAyB,EAAE,IAAI,CAAC;EACtFZ,QAAQ,CAACK,gBAAgB,CAAC,OAAO,EAAEf,OAAO,CAACoB,oBAAoB,EAAE,IAAI,CAAC;AAC1E,CAAC;;AAED;AACA;AACA;AACA;AACArB,gBAAgB,CAACE,SAAS,CAACoB,eAAe,GAAG,UAAUM,CAAC,EAAE;EACtD,IAAIe,GAAG,GAAGf,CAAC,CAACC,MAAM,IAAID,CAAC,CAACE,UAAU;EAClC,IAAIc,eAAe,GAAGD,GAAG,CAACX,OAAO,CAAC,gCAAgC,CAAC;EACnE,IAAI/B,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAIkB,gBAAgB,GAAGlB,OAAO,CAACmB,aAAa,CAAC,sCAAsC,CAAC;EAEpF,IAAIwB,eAAe,IAAI,IAAI,EAAE;IACzBhB,CAAC,CAACiB,eAAe,EAAE,EAAC;IACpB5C,OAAO,CAACuC,SAAS,CAACM,MAAM,CAAC,iCAAiC,CAAC;IAC3D3B,gBAAgB,CAACH,gBAAgB,CAAC,OAAO,EAAEf,OAAO,CAACsB,yBAAyB,EAAE,IAAI,CAAC;IACnFZ,QAAQ,CAAC+B,mBAAmB,CAAC,OAAO,EAAEzC,OAAO,CAACoB,oBAAoB,EAAE,IAAI,CAAC;EAC7E;AACJ,CAAC;;AAED;AACA;AACA;AACArB,gBAAgB,CAACE,SAAS,CAACwB,cAAc,GAAG,YAAY;EACpD,IAAIzB,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAIK,kBAAkB,GAAG,IAAI,CAACA,kBAAkB;EAChD,IAAIyC,aAAa,GAAG9C,OAAO,CAAC+C,aAAa;EACzC,IAAIC,eAAe,GAAGF,aAAa,CAACR,SAAS,GAAG,EAAE,EAAC;EACnD,IAAInC,MAAM,GAAGH,OAAO,CAACI,gBAAgB,CAAC,qCAAqC,CAAC;EAE5E,IAAIoB,MAAM,CAACyB,WAAW,IAAID,eAAe,EAAE;IACvChD,OAAO,CAACuC,SAAS,CAACM,MAAM,CAAC,iCAAiC,CAAC;EAC/D,CAAC,MAAM;IACH7C,OAAO,CAACuC,SAAS,CAACC,GAAG,CAAC,iCAAiC,CAAC;EAC5D;EAEA,IAAI,IAAI,CAACxC,OAAO,CAAC0B,YAAY,EAAE;IAC3B,IAAI,CAAC1B,OAAO,CAAC0B,YAAY,GAAG,KAAK;EACrC,CAAC,MAAM,IAAI1B,OAAO,CAACuC,SAAS,CAACW,QAAQ,CAAC,iCAAiC,CAAC,EAAE;IACtE,IAAIC,KAAK,GAAG,IAAI;IAChB9C,kBAAkB,CAAC+C,IAAI,CAAC,UAAU5C,KAAK,EAAE6C,MAAM,EAAE;MAC7C,IAAI7C,KAAK,CAACC,EAAE,CAAC6B,SAAS,IAAId,MAAM,CAAC8B,OAAO,IAAI9C,KAAK,CAACC,EAAE,CAAC6B,SAAS,IAAKd,MAAM,CAAC8B,OAAO,GAAG9B,MAAM,CAAC+B,WAAY,EAAE;QACrGJ,KAAK,CAACf,iBAAiB,CAACjC,MAAM,CAACkD,MAAM,CAAC,CAAC;QAEvC,OAAO,IAAI;MACf;IACJ,CAAC,CAAC;EACN,CAAC,MAAM;IACH,IAAI,CAACjB,iBAAiB,CAACjC,MAAM,CAAC,CAAC,CAAC,CAAC;EACrC;AACJ,CAAC;AAEDJ,gBAAgB,CAACE,SAAS,CAACmC,iBAAiB,GAAG,UAAU3B,EAAE,EAAE;EACzD,IAAIT,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAIwD,SAAS,GAAG/C,EAAE,CAACsB,OAAO,CAAC,qCAAqC,CAAC;EACjE,IAAI0B,aAAa,GAAGD,SAAS,CAACrC,aAAa,CAAC,sCAAsC,CAAC;EACnF,IAAIuC,MAAM,GAAG1D,OAAO,CAACI,gBAAgB,CAAC,qCAAqC,CAAC;EAC5E,IAAIuD,cAAc,GAAG3D,OAAO,CAACmB,aAAa,CAAC,6CAA6C,CAAC;EAEzFuC,MAAM,CAACpD,OAAO,CAAC,UAAUE,KAAK,EAAE;IAC5BA,KAAK,CAAC+B,SAAS,CAACM,MAAM,CAAC,4CAA4C,CAAC;EACxE,CAAC,CAAC;EACFW,SAAS,CAACjB,SAAS,CAACC,GAAG,CAAC,4CAA4C,CAAC;EACrEmB,cAAc,CAACC,SAAS,GAAGH,aAAa,CAACG,SAAS;;EAElD;EACAJ,SAAS,CAACK,cAAc,CAAC;IACvBC,KAAK,EAAE,SAAS;IAChBC,MAAM,EAAE;EACV,CAAC,CAAC;AACN,CAAC;AAED,eAAehE,gBAAgB"},"metadata":{},"sourceType":"module"}